# Consequence Definitions Index
# Registry of all consequence types with metadata for quick reference
# v3.0.0 - Consolidated types

schema_version: "3.0"
definition_file: consequences.yaml

# Remote extension definitions (public URLs)
# Users can add custom consequences from external sources
remote_sources:
  # Example: Custom Docker consequences
  # - url: https://raw.githubusercontent.com/hiivmind/blueprint-docker/main/consequences.yaml
  #   types: [docker_build, docker_push, docker_run]

types:
  # ==========================================================================
  # Core - Control (5 types)
  # ==========================================================================
  create_checkpoint:
    category: core/control
    brief: Save state snapshot for potential rollback
    required_params: [name]

  rollback_checkpoint:
    category: core/control
    brief: Restore state from checkpoint
    required_params: [name]

  spawn_agent:
    category: core/control
    brief: Launch a Task agent for parallel work
    required_params: [subagent_type, prompt, store_as]

  invoke_skill:
    category: core/control
    brief: Invoke another skill and wait for completion
    required_params: [skill]

  inline:
    category: core/control
    brief: Execute embedded pseudocode for non-reusable logic
    required_params: [description, pseudocode]

  # ==========================================================================
  # Core - Evaluation (2 types)
  # ==========================================================================
  evaluate:
    category: core/evaluation
    brief: Evaluate expression and set flag based on result
    required_params: [expression, set_flag]

  compute:
    category: core/evaluation
    brief: Run expression and store result
    required_params: [expression, store_as]

  # ==========================================================================
  # Core - Interaction (1 type) - CONSOLIDATED in v3.0
  # ==========================================================================
  display:
    category: core/interaction
    brief: Display content to user in various formats
    required_params: [format, content]
    replaces: [display_message, display_table]

  # ==========================================================================
  # Core - Logging (9 types) - log_entry CONSOLIDATED in v3.0
  # ==========================================================================
  init_log:
    category: core/logging
    brief: Initialize log structure with workflow metadata
    required_params: [workflow_name]

  log_node:
    category: core/logging
    brief: Record node execution in history
    required_params: [node, outcome]

  log_entry:
    category: core/logging
    brief: Log event with configurable severity level
    required_params: [level, message]
    replaces: [log_event, log_warning, log_error]

  log_session_snapshot:
    category: core/logging
    brief: Record mid-session checkpoint
    required_params: [description]

  finalize_log:
    category: core/logging
    brief: Complete log with timing and outcome
    required_params: [outcome]

  write_log:
    category: core/logging
    brief: Write log to file
    required_params: []

  apply_log_retention:
    category: core/logging
    brief: Clean up old log files
    required_params: [path, strategy]

  output_ci_summary:
    category: core/logging
    brief: Format output for CI environments
    required_params: []

  install_tool:
    category: core/logging
    brief: Install a CLI tool if not already available
    required_params: [tool]

  # ==========================================================================
  # Core - State (2 types) - mutate_state CONSOLIDATED in v3.0
  # ==========================================================================
  set_flag:
    category: core/state
    brief: Set a boolean flag
    required_params: [flag, value]

  mutate_state:
    category: core/state
    brief: Mutate state field with various operations
    required_params: [operation, field]
    replaces: [set_state, append_state, clear_state, merge_state]

  # ==========================================================================
  # Core - Utility (2 types)
  # ==========================================================================
  set_timestamp:
    category: core/utility
    brief: Set current ISO timestamp
    required_params: [store_as]

  compute_hash:
    category: core/utility
    brief: Compute SHA-256 hash of content
    required_params: [from, store_as]

  # ==========================================================================
  # Core - Intent (4 types)
  # ==========================================================================
  evaluate_keywords:
    category: core/intent
    brief: Match keywords to detect intent
    required_params: [input, keyword_sets, store_as]

  parse_intent_flags:
    category: core/intent
    brief: Parse 3VL flags from user input
    required_params: [input, flag_definitions, store_as]

  match_3vl_rules:
    category: core/intent
    brief: Match 3VL flags against rule table
    required_params: [flags, rules, store_as]

  dynamic_route:
    category: core/intent
    brief: Execute dynamically determined node transition
    required_params: [action]

  # ==========================================================================
  # Core - File System (1 type) - CONSOLIDATED in v3.0
  # ==========================================================================
  local_file_ops:
    category: core/filesystems
    brief: File system operations (read, write, mkdir, delete)
    required_params: [operation, path]
    replaces: [read_file, write_file, create_directory, delete_file]

  # ==========================================================================
  # Core - Git (1 type) - CONSOLIDATED in v3.0
  # ==========================================================================
  git_ops_local:
    category: core/git
    brief: Git operations (clone, pull, fetch, get-sha)
    required_params: [operation]
    replaces: [clone_repo, git_pull, git_fetch, get_sha]

  # ==========================================================================
  # Core - Web (1 type) - CONSOLIDATED in v3.0
  # ==========================================================================
  web_ops:
    category: core/web
    brief: Web operations (fetch, cache)
    required_params: [operation, url]
    replaces: [web_fetch, cache_web_content]

  # ==========================================================================
  # Core - Scripting (1 type) - CONSOLIDATED in v3.0
  # ==========================================================================
  run_command:
    category: core/scripting
    brief: Execute script with specified interpreter
    required_params: [interpreter, script]
    replaces: [run_script, run_python, run_bash]

# Statistics
stats:
  total_types: 31
  consolidated_from: 43
