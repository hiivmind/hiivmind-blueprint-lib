# Precondition Definitions Index
# Registry of all precondition types with metadata for quick reference

schema_version: "2.0"
definition_file: preconditions.yaml

# Remote extension definitions (public URLs)
# Users can add custom preconditions from external sources
remote_sources:
  # Example: Custom CI/CD preconditions
  # - url: https://raw.githubusercontent.com/hiivmind/blueprint-ci/main/preconditions.yaml
  #   types: [pipeline_passed, artifact_exists, deployment_ready]

types:
  # ==========================================================================
  # Core - Composite (4 types)
  # ==========================================================================
  all_of:
    category: core/composite
    brief: All nested conditions must be true (AND)
    required_params: [conditions]

  any_of:
    category: core/composite
    brief: At least one condition must be true (OR)
    required_params: [conditions]

  none_of:
    category: core/composite
    brief: No conditions may be true (NOR)
    required_params: [conditions]

  xor_of:
    category: core/composite
    brief: Exactly one condition must be true (XOR)
    required_params: [conditions]

  # ==========================================================================
  # Core - Expression (1 type)
  # ==========================================================================
  evaluate_expression:
    category: core/expression
    brief: Evaluate arbitrary boolean expression
    required_params: [expression]

  # ==========================================================================
  # Core - Filesystem (5 types)
  # ==========================================================================
  config_exists:
    category: core/filesystems
    brief: Check if corpus config.yaml exists
    required_params: []

  index_exists:
    category: core/filesystems
    brief: Check if corpus index.md exists
    required_params: []

  index_is_placeholder:
    category: core/filesystems
    brief: Check if index contains placeholder text
    required_params: []

  file_exists:
    category: core/filesystems
    brief: Check if arbitrary file exists
    required_params: [path]

  directory_exists:
    category: core/filesystems
    brief: Check if directory exists
    required_params: [path]

  # ==========================================================================
  # Core - Logging (3 types)
  # ==========================================================================
  log_initialized:
    category: core/logging
    brief: Check if logging has been initialized
    required_params: []

  log_level_enabled:
    category: core/logging
    brief: Check if log level allows specific threshold
    required_params: [level]

  log_finalized:
    category: core/logging
    brief: Check if logging has been finalized
    required_params: []

  # ==========================================================================
  # Core - State (8 types)
  # ==========================================================================
  flag_set:
    category: core/state
    brief: Check if a boolean flag is true
    required_params: [flag]

  flag_not_set:
    category: core/state
    brief: Check if a boolean flag is false or undefined
    required_params: [flag]

  state_equals:
    category: core/state
    brief: Check if state field equals specific value
    required_params: [field, value]

  state_not_null:
    category: core/state
    brief: Check if state field has a value
    required_params: [field]

  state_is_null:
    category: core/state
    brief: Check if state field is null or undefined
    required_params: [field]

  count_equals:
    category: core/state
    brief: Check if array length equals value
    required_params: [field, count]

  count_above:
    category: core/state
    brief: Check if array length exceeds threshold
    required_params: [field, min]

  count_below:
    category: core/state
    brief: Check if array length is below threshold
    required_params: [field, max]

  # ==========================================================================
  # Core - Tools (5 types)
  # ==========================================================================
  tool_available:
    category: core/tools
    brief: Check if command-line tool is installed
    required_params: [tool]

  tool_version_gte:
    category: core/tools
    brief: Check if tool version meets minimum requirement
    required_params: [tool, min_version]

  tool_authenticated:
    category: core/tools
    brief: Check if tool requiring authentication is authenticated
    required_params: [tool]

  tool_daemon_ready:
    category: core/tools
    brief: Check if tool's required daemon is running
    required_params: [tool]

  python_module_available:
    category: core/python
    brief: Check if Python module is installed
    required_params: [module]

  # ==========================================================================
  # Core - Network (1 type)
  # ==========================================================================
  network_available:
    category: core/network
    brief: Check if network access is available
    required_params: []

  # ==========================================================================
  # Core - Git (3 types)
  # ==========================================================================
  source_exists:
    category: core/git
    brief: Check if source ID exists in config.yaml
    required_params: [id]

  source_cloned:
    category: core/git
    brief: Check if source has been cloned
    required_params: [id]

  source_has_updates:
    category: core/git
    brief: Check if git source has upstream changes
    required_params: [id]

  # ==========================================================================
  # Core - Web Fetch (2 types)
  # ==========================================================================
  fetch_succeeded:
    category: core/web_fetch
    brief: Check if a previous web fetch succeeded
    required_params: [from]

  fetch_returned_content:
    category: core/web_fetch
    brief: Check if fetch returned non-empty content
    required_params: [from]

# Statistics
stats:
  total_types: 32
  core_types: 32
  extension_types: 0
